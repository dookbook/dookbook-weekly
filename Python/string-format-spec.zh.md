# 字符串格式规范 (String Format Specification)

**格式规范** 在格式字符串所包含的替换字段内部使用，用于定义单个值应如何呈现。

f-string 采用 `{content:format}` 设置字符串格式，其中 `content` 是替换并填入字符串的内容，可以是变量、表达式或函数等，`format` 是**格式描述符**。
采用默认格式时不必指定 `{:format}`。

## 对齐 (Alignment)

| 选项 (Option) | 意义 (Meaning) |
| :---: | :--- |
| `<` | 左对齐 (大多数对象默认对齐方式) |
| `>` | 右对齐 (数字默认对齐方式) |
| `>` | 居中 |
| `=` | 数字填充 (仅限于**数字**) |

```python
>>> text = 'AAA'

# < 左对齐
>>> f'{text:f<5}'
'AAAff'

# > 右对齐
>>> f'{text:f>5}'
'ffAAA'

# ^ 居中
>>> f'{text:f^5}'
'fAAAf'

# 不能完全居中时，靠左
>>> f'{text:f^6}'
'fAAAff'

# = 仅限于数字填充，否则抛出 ValueError 异常
>>> f'{text:f=6}'
ValueError: '=' alignment not allowed in string format specifier
>>> i = 6
>>> f'{i:0=5}'
'00006'
```

## 数字符号 (Sign)

!!! warn ""
    仅限于数字类型。

| 选项 (Option) | 意义 (Meaning) |
| :---: | --- |
| `+` | 负数前加负号（`-`），正数前加正号（`+`） |
| `-` | 负数前加负号（`-`），正数前不加任何符号（默认） |
| (空格) | 负数前加负号（`-`），正数前加一个空格 |

```python
>>> i = 6
>>> j = -2

# 不加符号
>>> f'{i:0=5}, {j:0=5}'
'00006, -0002'

# 符号为 +
>>> f'{i:0=+5}, {j:0=+5}'
'+0006, -0002'

# 符号为 -
>>> f'{i:0=-5}, {j:0=-5}'
'00006, -0002'

# 符号为 空格
>>> f'{i:0= 5}, {j:0= 5}'
' 0006, -0002'
```

## 整数格式

按 **`d`** (十进制) / **`n`** (本地locale十进制), **`b`** (二进制), **`o`** (八进制),
**`x`** (小写十六进制) / **`X`** (大写十六进制) 进制显示：

### 进制

```python
>>> i = 666666
>>> f'{i:d}, {i:n}, {i:b}, {i:o}, {i:x}, {i:X}'
'666666, 666666, 10100010110000101010, 2426052, a2c2a, A2C2A'
```

### 进制前缀

**`#`** 代表是否显示（十进制、本地locale十进制、二进制、八进制、小写十六进制、大写十六进制）**进制前缀**：

```python
>>> i = 666666
>>> f'{i:#d}, {i:#n}, {i:#b}, {i:#o}, {i:#x}, {i:#X}'
'666666, 666666, 0b10100010110000101010, 0o2426052, 0xa2c2a, 0XA2C2A'
```

### 千位分隔符: `,` / `_`

**`,`** 用于十进制整数的 **千位分隔符**：

```python
>>> i = 666666
>>> f'{i:#,d}'
'666,666'
```

**`_`** 用于二进制、八进制、十六进制整数的 **千位分隔符**：

```python
>>> i = 666666
>>> f'{i:#_b}, {i:#_o}, {i:#_x}, {i:#_X}'
'0b1010_0010_1100_0010_1010, 0o242_6052, 0xa_2c2a, 0XA_2C2A'
```

## 浮点数格式

```python
>>> i = 666666.666
>>> f'{i:f}'
'666666.666000'
```

### 千位分隔符: `,`

**`,`** 作为 **千位分隔符** 仅作用于浮点数的整数部分：

```python
>>> i = 666666.666
>>> f'result: {i:,f}, {i:_f}'
'result: 666,666.666000, 666_666.666000'
```

### 宽度 和 精度

```python
>>> i = 666666.666

>>> f'{i:f}'  # 精度默认是6
'666666.666000'

>>> f'{i:.2f}'  # 精度为2
'666666.67'

>>> f'{i:10.2f}'  # 宽度10(默认空格填充)，精度2
' 666666.67'

>>> f'{i:010.2f}'  # 宽度10(高位0填充)，精度2
'0666666.67'
```

综合实例：

```python
>>> i = 1234.5678
>>> f'{i = :<+10.2f}'  # 左对齐，宽度10位，显示正号（+），定点数格式，2位小数
'i = +1234.57  '
```

## 日期时间格式

```python
>>> from datetime import datetime
>>> today = datetime(year=2019, month=10, day=24)

>>> f'{today:%B %d, %Y}'  # using date format specifier
'October 24, 2019'
>>> f'{today:%Y-%m-%d %H:%M:%S}'
'2019-10-24 00:00:00'
```

## 推荐阅读

- [PEP 3101 – Advanced String Formatting](https://peps.python.org/pep-3101/)
- [PEP 498 – Literal String Interpolation](https://peps.python.org/pep-0498/)

## 参考文献

- [PEP 3101 – Advanced String Formatting](https://peps.python.org/pep-3101/)
